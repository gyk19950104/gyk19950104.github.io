<!DOCTYPE html>
<html lang=><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> Javaå¤šçº¿ç¨‹ - gyk&#39;s blog</title>
    <meta name="description" content="1.å¤šçº¿ç¨‹ å¤šçº¿ç¨‹å°±æ˜¯æŒ‡å¤šæ ¸CPUåŒæ—¶å¹²å¤šä»¶äº‹ åœ¨javaä¸­å¼€å¯å¤šçº¿ç¨‹æœ‰ä¸‰ç§æ–¹æ³•ï¼š ç»§æ‰¿Threadç±»ï¼Œ å®ç°Runnableæ¥å£ å®ç°Callableæ¥å£ ä½†Threadå› ä¸ºæ˜¯ç±»çš„ç»§æ‰¿ï¼Œæ‰€ä»¥æœ‰å•ç»§æ‰¿çš„å¼Šç«¯ï¼Œ Runnableæ˜¯æ¥å£å®ç°ï¼Œå¯ä»¥è¿›è¡Œå¤šç»§æ‰¿ï¼Œ ä½¿ç”¨æ—¶implementså®ç°æ¥å£é‡å†™runæ–¹æ³•ï¼Œä½†æ— è¿”å›å€¼ï¼Œ Callableæ˜¯æ¥å£å®ç°ï¼Œå¯ä»¥è¿›è¡Œå¤šç»§æ‰¿ï¼Œä¹Ÿæœ‰è¿”å›å€¼ï¼Œ æ ¹æ®ä¸åŒæƒ…å†µï¼Œåˆç†é€‰æ‹©ä½¿ç”¨Runnableå’ŒCallableæ¥å£ å¼€å¯å¤šçº¿ç¨‹åï¼Œç”±äºå¤šä¸ªçº¿ç¨‹æ‰§è¡Œé¡ºåºæ˜¯ç”±CPUè‡ªè¡Œè°ƒåº¦ï¼Œ è¿™ç§ä¸ç¡®å®šæ€§ä¼šå¼•èµ·æ‰§è¡Œç»“æœçš„ä¸ç¨³å®šæ€§ï¼Œé™¤æ‰§è¡Œé¡ºåºå¤–ï¼Œ è¿˜å¯èƒ½å‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä»½èµ„æºçš„æƒ…å†µï¼Œè¿™ä¼šå¯¼ è‡´èµ„æºä¸å®‰å…¨ï¼Œæ‰€ä»¥éœ€è¦çº¿ç¨‹åŒæ­¥ï¼Œå®ƒçš„æœ¬è´¨æ˜¯ä¸€ç§ç­‰å¾… çš„æœºåˆ¶ï¼Œåœ¨JDK5ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡synchronizedæ–¹ æ³•æˆ–è€…synchronizedåŒæ­¥å—æ¥å¯¹èµ„æºè¿›è¡Œéšå¼åŠ é”ï¼Œä¿ è¯å®‰å…¨ï¼Œåœ¨JDK5ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡locké”æœºåˆ¶æ¥æ˜¾å¼åŠ  é”ï¼Œä¿è¯å®‰å…¨ï¼Œä¸€èˆ¬å°‘é‡ä»£ç ç”¨synchronizedï¼Œå¤§é‡ä»£ç  ç”¨locké” ğŸ‘‰synchronizedæ–¹æ³•ï¼š å¯ä»¥é€šè¿‡privateå…³é”®å­—æ¥ä¿è¯æ•°æ®å¯¹è±¡åªèƒ½è¢«æ–¹æ³•è®¿é—®ï¼Œ æ‰€ä»¥åªéœ€è¦å¯¹è¿™ä¸ªæ–¹æ³•æå‡ºä¸€å¥—æœºåˆ¶ï¼Œè¿™å¥—æœºåˆ¶å°±æ˜¯ synchronized å…³é”®å­—ï¼Œå³synchronizedæ–¹æ³• ğŸ‘‰synchronizedåŒæ­¥å—ï¼š æœ‰æ—¶å¹¶ä¸éœ€è¦å¯¹æ•°æ®æ·»åŠ privateå…³é”®å­— ï¼Œè€Œæ˜¯åœ¨ä»£ç  ä¸­ç›´æ¥ä½¿ç”¨synchronized( Obj ){ }åŒæ­¥å—ï¼Œobjæ˜¯ ç±»ä¼¼äºä¸Šé¢çš„ç§æœ‰æ•°æ®å¯¹è±¡ ğŸ‘‰locké”æœºåˆ¶ï¼š å¤šçº¿ç¨‹ç¼–ç¨‹æ—¶åŒæ­¥é˜Ÿåˆ—ä¼šå‡ºç°å¾ˆå¤šå¸¸è§æ¶‰åŠåˆ°é”çš„æƒ…å½¢ï¼Œ åœ¨javaä¸­å°†è¿™äº›å¤šçº¿ç¨‹å¸¸è§æƒ…å½¢æŠ½è±¡å°è£…æˆå¼€ç®±å³ç”¨çš„ å·¥å…·åŒ…ï¼Œå«åšJUCï¼Œå¸¸è§çš„JUC.locksï¼ŒJUC.automic ç­‰ï¼Œå®ƒåŒ…å«äº†å¾ˆå¤šæ¥å£å’Œå®ç°ç±»ï¼Œå¯ä»¥æ‹¿æ¥å³ç”¨ =========================================== 2.1åˆ›å»ºï¼šthreadï¼Œrunnableï¼Œcallable ===========================================
//åˆ›å»º //ç»§æ‰¿Threadç±»,é‡å†™runæ–¹æ³•ï¼Œæ–°å»ºå¯¹è±¡åstartå¼€å¯çº¿ç¨‹ package wiki.mrx.www; public class TestThread extends Thread{ //ä¸»çº¿ç¨‹ public static void main(String[] args) { //åˆ›å»ºå¹¶å¼€å¯çº¿ç¨‹ TestThread t1 = new TestThread(); t1.start(); //ä¸»çº¿ç¨‹ä»£ç  for (int i=0;i&lt;20;i&#43;&#43;){ System.out.println(&quot;æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹&quot;&#43;i); } } @Override public void run() { for (int i=0;i&lt;20;i&#43;&#43;){ System.">
    <link rel="canonical" href="https://gyk19950104.github.io/backend/2.java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">
    <meta property="og:title" content="Javaå¤šçº¿ç¨‹">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://gyk19950104.github.io/backend/2.java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">
    <meta property="og:description" content="1.å¤šçº¿ç¨‹ å¤šçº¿ç¨‹å°±æ˜¯æŒ‡å¤šæ ¸CPUåŒæ—¶å¹²å¤šä»¶äº‹ åœ¨javaä¸­å¼€å¯å¤šçº¿ç¨‹æœ‰ä¸‰ç§æ–¹æ³•ï¼š ç»§æ‰¿Threadç±»ï¼Œ å®ç°Runnableæ¥å£ å®ç°Callableæ¥å£ ä½†Threadå› ä¸ºæ˜¯ç±»çš„ç»§æ‰¿ï¼Œæ‰€ä»¥æœ‰å•ç»§æ‰¿çš„å¼Šç«¯ï¼Œ Runnableæ˜¯æ¥å£å®ç°ï¼Œå¯ä»¥è¿›è¡Œå¤šç»§æ‰¿ï¼Œ ä½¿ç”¨æ—¶implementså®ç°æ¥å£é‡å†™runæ–¹æ³•ï¼Œä½†æ— è¿”å›å€¼ï¼Œ Callableæ˜¯æ¥å£å®ç°ï¼Œå¯ä»¥è¿›è¡Œå¤šç»§æ‰¿ï¼Œä¹Ÿæœ‰è¿”å›å€¼ï¼Œ æ ¹æ®ä¸åŒæƒ…å†µï¼Œåˆç†é€‰æ‹©ä½¿ç”¨Runnableå’ŒCallableæ¥å£ å¼€å¯å¤šçº¿ç¨‹åï¼Œç”±äºå¤šä¸ªçº¿ç¨‹æ‰§è¡Œé¡ºåºæ˜¯ç”±CPUè‡ªè¡Œè°ƒåº¦ï¼Œ è¿™ç§ä¸ç¡®å®šæ€§ä¼šå¼•èµ·æ‰§è¡Œç»“æœçš„ä¸ç¨³å®šæ€§ï¼Œé™¤æ‰§è¡Œé¡ºåºå¤–ï¼Œ è¿˜å¯èƒ½å‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä»½èµ„æºçš„æƒ…å†µï¼Œè¿™ä¼šå¯¼ è‡´èµ„æºä¸å®‰å…¨ï¼Œæ‰€ä»¥éœ€è¦çº¿ç¨‹åŒæ­¥ï¼Œå®ƒçš„æœ¬è´¨æ˜¯ä¸€ç§ç­‰å¾… çš„æœºåˆ¶ï¼Œåœ¨JDK5ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡synchronizedæ–¹ æ³•æˆ–è€…synchronizedåŒæ­¥å—æ¥å¯¹èµ„æºè¿›è¡Œéšå¼åŠ é”ï¼Œä¿ è¯å®‰å…¨ï¼Œåœ¨JDK5ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡locké”æœºåˆ¶æ¥æ˜¾å¼åŠ  é”ï¼Œä¿è¯å®‰å…¨ï¼Œä¸€èˆ¬å°‘é‡ä»£ç ç”¨synchronizedï¼Œå¤§é‡ä»£ç  ç”¨locké” ğŸ‘‰synchronizedæ–¹æ³•ï¼š å¯ä»¥é€šè¿‡privateå…³é”®å­—æ¥ä¿è¯æ•°æ®å¯¹è±¡åªèƒ½è¢«æ–¹æ³•è®¿é—®ï¼Œ æ‰€ä»¥åªéœ€è¦å¯¹è¿™ä¸ªæ–¹æ³•æå‡ºä¸€å¥—æœºåˆ¶ï¼Œè¿™å¥—æœºåˆ¶å°±æ˜¯ synchronized å…³é”®å­—ï¼Œå³synchronizedæ–¹æ³• ğŸ‘‰synchronizedåŒæ­¥å—ï¼š æœ‰æ—¶å¹¶ä¸éœ€è¦å¯¹æ•°æ®æ·»åŠ privateå…³é”®å­— ï¼Œè€Œæ˜¯åœ¨ä»£ç  ä¸­ç›´æ¥ä½¿ç”¨synchronized( Obj ){ }åŒæ­¥å—ï¼Œobjæ˜¯ ç±»ä¼¼äºä¸Šé¢çš„ç§æœ‰æ•°æ®å¯¹è±¡ ğŸ‘‰locké”æœºåˆ¶ï¼š å¤šçº¿ç¨‹ç¼–ç¨‹æ—¶åŒæ­¥é˜Ÿåˆ—ä¼šå‡ºç°å¾ˆå¤šå¸¸è§æ¶‰åŠåˆ°é”çš„æƒ…å½¢ï¼Œ åœ¨javaä¸­å°†è¿™äº›å¤šçº¿ç¨‹å¸¸è§æƒ…å½¢æŠ½è±¡å°è£…æˆå¼€ç®±å³ç”¨çš„ å·¥å…·åŒ…ï¼Œå«åšJUCï¼Œå¸¸è§çš„JUC.locksï¼ŒJUC.automic ç­‰ï¼Œå®ƒåŒ…å«äº†å¾ˆå¤šæ¥å£å’Œå®ç°ç±»ï¼Œå¯ä»¥æ‹¿æ¥å³ç”¨ =========================================== 2.1åˆ›å»ºï¼šthreadï¼Œrunnableï¼Œcallable ===========================================
//åˆ›å»º //ç»§æ‰¿Threadç±»,é‡å†™runæ–¹æ³•ï¼Œæ–°å»ºå¯¹è±¡åstartå¼€å¯çº¿ç¨‹ package wiki.mrx.www; public class TestThread extends Thread{ //ä¸»çº¿ç¨‹ public static void main(String[] args) { //åˆ›å»ºå¹¶å¼€å¯çº¿ç¨‹ TestThread t1 = new TestThread(); t1.start(); //ä¸»çº¿ç¨‹ä»£ç  for (int i=0;i&lt;20;i&#43;&#43;){ System.out.println(&quot;æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹&quot;&#43;i); } } @Override public void run() { for (int i=0;i&lt;20;i&#43;&#43;){ System.">
    <meta property="og:site_name" content="gyk&#39;s blog">
    <link rel="stylesheet" href="https://gyk19950104.github.io/css/main.min.7fdf1d02dafd1a6eb5cfd0d707e17e33515b866f5d305a0ab01a4095577484fe.css" integrity="sha256-f98dAtr9Gm61z9DXB&#43;F&#43;M1Fbhm9dMFoKsBpAlVd0hP4=">
    <meta name="generator" content="Hugo 0.73.0" />
    <script type="module" src="https://unpkg.com/ionicons@5.1.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule="" src="https://unpkg.com/ionicons@5.1.2/dist/ionicons/ionicons.js"></script>
    
</head>
<body><header class="site-header">
    <nav class="site-nav" role="navigation" aria-label="breadcrumb">
    <ol itemscope itemtype="https://schema.org/BreadcrumbList" class="breadcrumb"><li class="breadcrumb-item  " 
  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
  <a itemtype="https://schema.org/Thing" itemprop="item" href="https://gyk19950104.github.io/">
    <span itemprop="name">gyk&#39;s blog</span>
  </a>
  <meta itemprop="position" content="0" />
</li>/<li class="breadcrumb-item  " 
  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
  <a itemtype="https://schema.org/Thing" itemprop="item" href="https://gyk19950104.github.io/backend/">
    <span itemprop="name">backend</span>
  </a>
  <meta itemprop="position" content="0" />
</li>/<li class="breadcrumb-item active hidden" aria-current="page"
  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
  <a itemtype="https://schema.org/Thing" itemprop="item" href="https://gyk19950104.github.io/backend/2.java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">
    <span itemprop="name">2.java%E5%A4%9A%E7%BA%BF%E7%A8%8B</span>
  </a>
  <meta itemprop="position" content="1" />
</li></ol>
    </nav>
    <h1 class="site-title hidden">
    <a href="https://gyk19950104.github.io">gyk&#39;s blog</a>
    </h1>
</header>
<div>å…ˆæœ‰é€»è¾‘æ­£ç¡®çš„æ€è·¯ï¼Œå‰©ä½™çš„æ˜¯é‡å¤çš„å®è·µä¸ç§¯ç´¯</div>
<main id="content">
<article role="article" class="content post h-entry" itemscope="" itemtype="http://schema.org/BlogPosting">
    <header class="post-header">        
        <h2 class="post-title" itemprop="name headline">Javaå¤šçº¿ç¨‹</h2>
        <span class="post-meta">
            <time class="date-published" datetime="2021-06-01T17:22:28&#43;07:00" itemprop="datePublished">
                Tue, 1 Jun 2021
            </time>
            
        </span>
    </header>
    <div class="post-content" itemprop="articleBody">
        <h2 id="1å¤šçº¿ç¨‹">1.å¤šçº¿ç¨‹</h2>
<pre><code>å¤šçº¿ç¨‹å°±æ˜¯æŒ‡å¤šæ ¸CPUåŒæ—¶å¹²å¤šä»¶äº‹
åœ¨javaä¸­å¼€å¯å¤šçº¿ç¨‹æœ‰ä¸‰ç§æ–¹æ³•ï¼š
ç»§æ‰¿Threadç±»ï¼Œ
å®ç°Runnableæ¥å£
å®ç°Callableæ¥å£
ä½†Threadå› ä¸ºæ˜¯ç±»çš„ç»§æ‰¿ï¼Œæ‰€ä»¥æœ‰å•ç»§æ‰¿çš„å¼Šç«¯ï¼Œ
Runnableæ˜¯æ¥å£å®ç°ï¼Œå¯ä»¥è¿›è¡Œå¤šç»§æ‰¿ï¼Œ
ä½¿ç”¨æ—¶implementså®ç°æ¥å£é‡å†™runæ–¹æ³•ï¼Œä½†æ— è¿”å›å€¼ï¼Œ
Callableæ˜¯æ¥å£å®ç°ï¼Œå¯ä»¥è¿›è¡Œå¤šç»§æ‰¿ï¼Œä¹Ÿæœ‰è¿”å›å€¼ï¼Œ
æ ¹æ®ä¸åŒæƒ…å†µï¼Œåˆç†é€‰æ‹©ä½¿ç”¨Runnableå’ŒCallableæ¥å£

å¼€å¯å¤šçº¿ç¨‹åï¼Œç”±äºå¤šä¸ªçº¿ç¨‹æ‰§è¡Œé¡ºåºæ˜¯ç”±CPUè‡ªè¡Œè°ƒåº¦ï¼Œ
è¿™ç§ä¸ç¡®å®šæ€§ä¼šå¼•èµ·æ‰§è¡Œç»“æœçš„ä¸ç¨³å®šæ€§ï¼Œé™¤æ‰§è¡Œé¡ºåºå¤–ï¼Œ
è¿˜å¯èƒ½å‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä»½èµ„æºçš„æƒ…å†µï¼Œè¿™ä¼šå¯¼
è‡´èµ„æºä¸å®‰å…¨ï¼Œæ‰€ä»¥éœ€è¦çº¿ç¨‹åŒæ­¥ï¼Œå®ƒçš„æœ¬è´¨æ˜¯ä¸€ç§ç­‰å¾…
çš„æœºåˆ¶ï¼Œåœ¨JDK5ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡synchronizedæ–¹
æ³•æˆ–è€…synchronizedåŒæ­¥å—æ¥å¯¹èµ„æºè¿›è¡Œéšå¼åŠ é”ï¼Œä¿
è¯å®‰å…¨ï¼Œåœ¨JDK5ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡locké”æœºåˆ¶æ¥æ˜¾å¼åŠ 
é”ï¼Œä¿è¯å®‰å…¨ï¼Œä¸€èˆ¬å°‘é‡ä»£ç ç”¨synchronizedï¼Œå¤§é‡ä»£ç 
ç”¨locké”

ğŸ‘‰synchronizedæ–¹æ³•ï¼š
å¯ä»¥é€šè¿‡privateå…³é”®å­—æ¥ä¿è¯æ•°æ®å¯¹è±¡åªèƒ½è¢«æ–¹æ³•è®¿é—®ï¼Œ
æ‰€ä»¥åªéœ€è¦å¯¹è¿™ä¸ªæ–¹æ³•æå‡ºä¸€å¥—æœºåˆ¶ï¼Œè¿™å¥—æœºåˆ¶å°±æ˜¯ 
synchronized å…³é”®å­—ï¼Œå³synchronizedæ–¹æ³•

ğŸ‘‰synchronizedåŒæ­¥å—ï¼š
æœ‰æ—¶å¹¶ä¸éœ€è¦å¯¹æ•°æ®æ·»åŠ privateå…³é”®å­— ï¼Œè€Œæ˜¯åœ¨ä»£ç 
ä¸­ç›´æ¥ä½¿ç”¨synchronized( Obj ){ }åŒæ­¥å—ï¼Œobjæ˜¯
ç±»ä¼¼äºä¸Šé¢çš„ç§æœ‰æ•°æ®å¯¹è±¡

ğŸ‘‰locké”æœºåˆ¶ï¼š
å¤šçº¿ç¨‹ç¼–ç¨‹æ—¶åŒæ­¥é˜Ÿåˆ—ä¼šå‡ºç°å¾ˆå¤šå¸¸è§æ¶‰åŠåˆ°é”çš„æƒ…å½¢ï¼Œ
åœ¨javaä¸­å°†è¿™äº›å¤šçº¿ç¨‹å¸¸è§æƒ…å½¢æŠ½è±¡å°è£…æˆå¼€ç®±å³ç”¨çš„
å·¥å…·åŒ…ï¼Œå«åšJUCï¼Œå¸¸è§çš„JUC.locksï¼ŒJUC.automic
ç­‰ï¼Œå®ƒåŒ…å«äº†å¾ˆå¤šæ¥å£å’Œå®ç°ç±»ï¼Œå¯ä»¥æ‹¿æ¥å³ç”¨
</code></pre><p><code>===========================================</code>
<code>2.1åˆ›å»ºï¼šthreadï¼Œrunnableï¼Œcallable</code>
<code>===========================================</code></p>
<pre><code>//åˆ›å»º
//ç»§æ‰¿Threadç±»,é‡å†™runæ–¹æ³•ï¼Œæ–°å»ºå¯¹è±¡åstartå¼€å¯çº¿ç¨‹
package wiki.mrx.www;

public class TestThread extends Thread{
    //ä¸»çº¿ç¨‹
    public static void main(String[] args) {
        //åˆ›å»ºå¹¶å¼€å¯çº¿ç¨‹
        TestThread t1 = new TestThread();
        t1.start();
        //ä¸»çº¿ç¨‹ä»£ç 
        for (int i=0;i&lt;20;i++){
            System.out.println(&quot;æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹&quot;+i);
        }

    }

    @Override
    public void run() {
        for (int i=0;i&lt;20;i++){
            System.out.println(&quot;æˆ‘åœ¨çœ‹ä»£ç &quot;+i);
        }
    }
}

</code></pre><pre><code>//å®ç°Runnableæ¥å£ï¼šå®ç°runnableæ¥å£ï¼Œé‡å†™runæ–¹æ³•ï¼Œåˆ›å»ºå¯¹è±¡åä¸¢å…¥threadä¸­start
package wiki.mrx.www;
//å†™çš„æ—¶å€™è„‘å­é‡Œå‡ºç°å¹¶è¡Œçš„ä¸»çº¿ å’Œ çº¿ç¨‹æ‰§è¡Œçš„çº¿
//åˆ›å»ºimplements Runnableçš„ç±»åé‡å†™runæ–¹æ³•ï¼Œæ‰§è¡Œè¯¥çº¿ç¨‹å†…çš„é€»è¾‘
//ä¸»çº¿ç¨‹Stop stop = new Stop();new Thread(stop).start();


    public class TestThread implements Runnable{
        //ä¸»çº¿ç¨‹
        public static void main(String[] args) {
            //åˆ›å»ºå¹¶å¼€å¯çº¿ç¨‹
            TestThread testThread = new TestThread();
            new Thread(testThread).start();
            //ä¸»çº¿ç¨‹ä»£ç 
            for (int i=0;i&lt;20;i++){
                System.out.println(&quot;æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹&quot;+i);
            }

        }

        @Override
        public void run() {
            for (int i=0;i&lt;20;i++){
                System.out.println(&quot;æˆ‘åœ¨çœ‹ä»£ç &quot;+i);
            }
        }
    }


</code></pre><pre><code>//å®ç°Callableæ¥å£



</code></pre><pre><code>//åœæ­¢
package wiki.mrx.www;



public class Stop implements Runnable {
    //1.è®¾ç½®åœæ­¢æ ‡å¿—ä½
    private boolean flag = true;

    @Override
    public void run() {
        int i = 0;
        while (flag){
            System.out.println(&quot;run .... thrread&quot; + i++);
        }
    }

    //2.è®¾ç½®å…¬å¼€åœæ­¢æ–¹æ³•
    public void stop(){
        this.flag = false;
    }

    //3.ä¸»çº¿ç¨‹
    public static void main(String[] args) {
        Stop stop = new Stop();
        new Thread(stop).start();
        for (int i = 0; i &lt; 1000; i++) {
            System.out.println(&quot;main&quot;+i);
            if(i==900){
                stop.stop();
                System.out.println(&quot;è¯¥çº¿ç¨‹åœæ­¢&quot;);
            }
        }
    }
}


</code></pre><p><code>===========================================</code>
<code>2.2 å¹¶å‘ï¼šå¤šçº¿ç¨‹åŒæ—¶æŠ¢å¤ºåŒä¸€èµ„æºï¼Œå¯ç”¨synchronizedé”ä½èµ„æºè¿›å…¥é˜Ÿåˆ—æ¨¡å¼ï¼Œä¹Ÿå¯ä½¿ç”¨locké”å®ç°</code>
<code>===========================================</code></p>
<p><code>è¿›ç¨‹é”æœºåˆ¶</code></p>
<pre><code>//æœªä¸Šé”æ—¶ä¸åŒè¿›ç¨‹æŠ¢å¤ºåŒä¸€èµ„æºæ—¶ä¼šå¯¼è‡´èµ„æºè¢«é‡å¤ä½¿ç”¨
package wiki.mrx.www;

public class UnsafeBuyTicket {
    public static void main(String[] args) {
        BuyTicket station = new BuyTicket();
        new Thread(station,&quot;kk&quot;).start();
        new Thread(station,&quot;nn&quot;).start();
        new Thread(station,&quot;ll&quot;).start();
    }
}


class BuyTicket implements Runnable{
    private  int ticketNums = 10;
    boolean flag = true;

    @Override
    public void run() {
        //ä¹°ç¥¨
        while(flag){
            buy();
        }
    }

    private void buy(){
        //åˆ¤æ–­æ˜¯å¦æœ‰ç¥¨
        if(ticketNums &lt;=0 ){
            flag = false;
            return;
        };
        //æ¨¡æ‹Ÿå»¶æ—¶
        try{
            Thread.sleep(100);
        }catch (InterruptedException e){
            e.printStackTrace();
        }

        System.out.println(Thread.currentThread().getName()+&quot;æ‹¿åˆ°&quot;+ticketNums--);
    }
};


</code></pre><pre><code>//buyæ–¹æ³•é€šè¿‡synchronizedä¸Šé”
package wiki.mrx.www;

public class UnsafeBuyTicket {
    public static void main(String[] args) {
        BuyTicket station = new BuyTicket();
        new Thread(station,&quot;kk&quot;).start();
        new Thread(station,&quot;nn&quot;).start();
        new Thread(station,&quot;ll&quot;).start();
    }
}


class BuyTicket implements Runnable{
    private  int ticketNums = 10;
    boolean flag = true;

    @Override
    public void run() {
        //ä¹°ç¥¨
        while(flag){
            try{
                buy();
            }catch (InterruptedException e){
                e.printStackTrace();
            }
        }
    }

    private synchronized void buy() throws InterruptedException{
        //åˆ¤æ–­æ˜¯å¦æœ‰ç¥¨
        if(ticketNums &lt;=0 ){
            flag = false;
            return;
        };
        //æ¨¡æ‹Ÿå»¶æ—¶
        Thread.sleep(100);

        System.out.println(Thread.currentThread().getName()+&quot;æ‹¿åˆ°&quot;+ticketNums--);
    }
};
</code></pre><p><code>æ­»é”:å¤šä¸ªçº¿ç¨‹äº’ç›¸å ç”¨å¯¹æ–¹çš„èµ„æºå¯¼è‡´å½¼æ­¤éƒ½è¿›è¡Œä¸ä¸‹å»</code></p>
<pre><code>package wiki.mrx.www;

public class DeadLock {
    public static void main(String[] args) {
        MakeUp g1 = new MakeUp(0,&quot;ç°å§‘å¨˜&quot;);
        MakeUp g2 = new MakeUp(1,&quot;ç™½é›ªå…¬ä¸»&quot;);
        g1.start();
        g2.start();
    }
}

//å£çº¢
class LipStick{

}

//é•œå­
class Mirror{

}

//åŒ–å¦†
class MakeUp extends Thread{
    //éœ€è¦çš„èµ„æºåªæœ‰ä¸€ä»½
    static LipStick lipstick = new LipStick();
    static  Mirror mirror = new Mirror();

    int choice;
    String girlName;

    MakeUp(int choice, String girlName){
        this.choice = choice;
        this.girlName = girlName;
    }
    @Override
    public void run() {
        try {
            makeup();
        }catch (InterruptedException e){
            e.printStackTrace();
        }
    }

    //åŒ–å¦†ï¼Œäº’ç›¸æŒæœ‰å¯¹æ–¹çš„èµ„æº
    private void makeup() throws InterruptedException{
        if(choice == 0){
            synchronized (lipstick){
                //è·å¾—å£çº¢çš„é”
                System.out.println(this.girlName+&quot;è·å¾—å£çº¢çš„èµ„æº&quot;);
                Thread.sleep(1000);
            }

            synchronized (mirror){
                //ä¸€ç§’é’Ÿåæƒ³è·å¾—é•œå­èµ„æº
                System.out.println(this.girlName+&quot;è·å¾—é•œå­çš„èµ„æº&quot;);
            }
        }else{
            synchronized (mirror){
                //è·å¾—å£çº¢çš„é”
                System.out.println(this.girlName+&quot;è·å¾—å£çº¢çš„èµ„æº&quot;);
                Thread.sleep(2000);
            }

            synchronized (lipstick){
                //ä¸€ç§’é’Ÿåæƒ³è·å¾—é•œå­èµ„æº
                System.out.println(this.girlName+&quot;è·å¾—é•œå­çš„èµ„æº&quot;);
            }
        }
    }
}

</code></pre><p><code>locké”</code></p>
<pre><code>package wiki.mrx.www;

import java.util.concurrent.locks.ReentrantLock;

public class TestLock {
    public static void main(String[] args) {
        TestLock2 testLock2 = new TestLock2();
        new Thread(testLock2).start();
        new Thread(testLock2).start();
        new Thread(testLock2).start();
    }
}

class TestLock2 implements Runnable{
    int ticketNums = 10;
    //å®šä¹‰locké”
    private final ReentrantLock lock = new ReentrantLock();

    @Override
    public void run() {
        while(true){
            try{
                //åŠ é”
                lock.lock();
                if(ticketNums &gt; 0){
                    //æ¨¡æ‹Ÿå»¶æ—¶
                    try {
                        Thread.sleep(1000);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                    //ä¹°ç¥¨
                    System.out.println(ticketNums--);
                }else{
                    break;
                }
            }finally {
                //è§£é”
                lock.unlock();
            }
        }
    }
}


</code></pre><p><code>===========================================</code>
<code>è¿›ç¨‹é€šä¿¡ï¼šå¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡ä½¿ç”¨awaitè¿›è¡Œå”¤é†’ç­‰å¾…ï¼Œä¹Ÿå¯ä½¿ç”¨jucä¸­condition.await/signalå®ç°</code>
<code>===========================================</code></p>
<pre><code>package wiki.mrx.www;

//1.ç®¡ç¨‹æ³•
import com.sun.xml.internal.xsom.impl.SchemaImpl;

//ç®¡ç¨‹æ³•
//ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…ï¼Œäº§å“ï¼Œç¼“å†²åŒº
public class TestPC {
    public static void main(String[] args) {
        SynContainer container = new SynContainer();
        new Productor(container).start();
        new Consumer(container).start();
    }
}

//ç”Ÿäº§è€…
class Productor extends Thread{
    SynContainer container;

    public Productor(SynContainer container) {
        this.container = container;
    }
    //ç”Ÿäº§

    @Override
    public void run() {
        for (int i = 0; i &lt; 100; i++) {
            container.push(new Chicken(i));
            System.out.println(&quot;ç”Ÿäº§äº†&quot;+i+&quot;åªé¸¡&quot;);
        }
    }
}
//æ¶ˆè´¹è€…
class Consumer extends Thread{
    SynContainer container;

    public Consumer(SynContainer container) {
        this.container = container;
    }
    //æ¶ˆè´¹

    @Override
    public void run() {
        for (int i = 0; i &lt; 100; i++) {
            System.out.println(&quot;æ¶ˆè´¹äº†&quot;+container.pop().id+&quot;åªé¸¡&quot;);
        }
    }
}
//äº§å“
class Chicken{
    int id;
    public Chicken(int id) {
        this.id = id;
    }
}
//ç¼“å†²åŒº
class SynContainer{
    //éœ€è¦ä¸€ä¸ªå®¹å™¨å¤§å°
    Chicken[] chickens = new Chicken[10];
    //å®¹å™¨è®¡æ•°å™¨
    int count = 0;

    //ç”Ÿäº§è€…æ”¾å…¥äº§å“
    public synchronized void push(Chicken chicken){
        //å¦‚æœå®¹å™¨æ»¡äº†å°±éœ€è¦ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹
        if(count == chickens.length){
            //é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ç”Ÿäº§ç­‰å¾…
            try{
                this.wait();
            }catch (InterruptedException e){
                e.printStackTrace();
            }
        }
        //å¦‚æœæ²¡æœ‰æ»¡å°±éœ€è¦ä¸¢å…¥äº§å“
        chickens[count] = chicken;
        count++;
        //å¯ä»¥é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹äº†
        this.notify();
    }



    //æ¶ˆè´¹è€…æ¶ˆè´¹äº§å“
    public synchronized Chicken pop(){
        // åˆ¤æ–­èƒ½å¦æ¶ˆè´¹
        if(count == 0){
            //ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§ï¼Œæ¶ˆè´¹è€…ç­‰å¾…
            try{
                this.wait();
            }catch (InterruptedException e){
                e.printStackTrace();
            }
        }

        //å¦‚æœå¯ä»¥æ¶ˆè´¹
        count--;
        Chicken chicken = chickens[count];

        //é€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§
        this.notifyAll();
        return chicken;

    }

}


</code></pre><pre><code>
package wiki.mrx.www;

//2.ä¿¡å·ç¯æ³•

public class TestPC {
    public static void main(String[] args) {
        TV tv = new TV();
        new Player(tv).start();
        new Watcher(tv).start();
    }
}


//ç”Ÿäº§è€…ï¼šæ¼”å‘˜
class Player extends Thread{
    TV tv;
    public Player(TV tv){
        this.tv = tv;
    }

    @Override
    public void run() {
        for (int i = 0; i &lt; 20; i++) {
            if(i%2==0){
                this.tv.play(&quot;å¿«ä¹å¤§æœ¬è¥&quot;);
            }else{
                this.tv.play(&quot;æŠ–éŸ³è®°å½•ç¾å¥½ç”Ÿæ´»&quot;);
            }
        }
    }
}
//æ¶ˆè´¹è€…ï¼šè§‚ä¼—
class Watcher extends Thread{
    TV tv;
    public Watcher(TV tv){
        this.tv = tv;
    }
    @Override
    public void run() {
        for (int i = 0; i &lt; 20; i++) {
            tv.watch();
        }
}

//äº§å“ï¼šèŠ‚ç›®
class TV {
    //æ¼”å‘˜è¡¨æ¼”ï¼Œè§‚ä¼—ç­‰å¾…T
    //è§‚ä¼—è§‚çœ‹ï¼Œæ¼”å‘˜ç­‰å¾…F
    String voice;
    boolean flag = true;
    //è¡¨æ¼”
    public synchronized void play(String voice){
        if(!flag){
            try{
                this.wait();
            }catch (InterruptedException e){
                e.printStackTrace();
            };
        };
        System.out.println(&quot;æ¼”å‘˜è¡¨æ¼”äº†&quot;+voice);
        
        //é€šçŸ¥è§‚ä¼—è§‚çœ‹
        this.notifyAll();
        this.voice = voice;
        this.flag = !this.flag;
    };

    //è§‚çœ‹
    public synchronized void watch(){
        if(flag){
            try{
                this.wait();
            }catch (InterruptedException e){
                e.printStackTrace();
            }
        }
        System.out.println(&quot;è§‚çœ‹äº†&quot;+voice);
        //é€šçŸ¥æ¼”å‘˜è¡¨æ¼”
        this.notifyAll();
        this.flag = !this.flag;
    };

}
</code></pre><p><code>===========================================</code>
<code>çº¿ç¨‹æ± ï¼šä¸‰å¤§æ–¹æ³•ï¼Œä¸ƒå¤§å‚æ•°ï¼Œå››å¤§æ‹’ç»ç­–ç•¥</code>
<code>===========================================</code></p>
<pre><code>import java.sql.Time;
import java.util.concurrent.*;

public class Thread {
    public static void main(String[] args) {
        //ExecutorService threadPool = Executors.newSingleThreadExecutor();//å•ä¸ªçº¿ç¨‹
        //ExecutorService threadPool = Executors.newFixedThreadPool(5)ï¼›//å›ºå®šå¤§å°çš„çº¿ç¨‹æ± 
        //ExecutorService threadPool = Executors.newCachedThreadPool();//å¯ä¼¸ç¼©çº¿ç¨‹æ± 
        ExecutorService threadPool = new ThreadPoolExecutor(
                2,
                5,
                3,
                TimeUnit.SECONDS,
                new LinkedBlockingDeque&lt;&gt;(3),
                Executors.defaultThreadFactory(),
                new ThreadPoolExecutor.AbortPolicy()
        );
        try{
            for(int i = 0; i&lt; 100; i++) {
                threadPool.execute(() -&gt; System.out.println(&quot;ok&quot;));
             }
        }catch(Exception e){
                e.printStackTrace();
        }finally {
            threadPool.shutdown();
        }
    }
}

</code></pre><p>1.å¤šçº¿ç¨‹ï¼ˆä¸€ï¼‰ï¼šåˆ›å»º- runnableæ¥å£</p>
<p><a href="https://www.kuangstudy.com/bbs/1380350988233326593">https://www.kuangstudy.com/bbs/1380350988233326593</a></p>
<p>2.å¤šçº¿ç¨‹ï¼ˆäºŒï¼‰ï¼šå¹¶å‘-locké”</p>
<p><a href="https://www.kuangstudy.com/bbs/1380834418435944450">https://www.kuangstudy.com/bbs/1380834418435944450</a></p>
<p>3.å¤šçº¿ç¨‹ï¼ˆä¸‰ï¼‰ï¼šé€šä¿¡-</p>
<p><a href="https://www.kuangstudy.com/bbs/1374924783082303489">https://www.kuangstudy.com/bbs/1374924783082303489</a></p>
<p>4.å¤šçº¿ç¨‹ï¼ˆå››ï¼‰ï¼šJUC</p>
<p><a href="https://www.kuangstudy.com/bbs/1374924783082303489">https://www.kuangstudy.com/bbs/1374924783082303489</a></p>

    </div>
</article>
<div class="pagination">
    
    <div class="prev"> <a href="https://gyk19950104.github.io/backend/1.java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">Previous Post</a> </div>
    
    
    <div class="next"> <a href="https://gyk19950104.github.io/backend/3.javaio%E6%B5%81/">Next Post</a> </div>
    
</div>


        </main><footer class="site-footer">
	<span class="right">
		<em>gyk&#39;s blog</em>
	</span>
</footer>
</body>
</html>
